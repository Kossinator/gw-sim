<template>
    <base-toast></base-toast>

    <div class="slds-grid">
        <div class="slds-col slds-size_1-of-3">
            <section class="account-select slds-p-bottom--x-small">
                Account:<base-select class="slds-show_inline-block slds-m-horizontal--small"
                                    value={cache.selectedAccount} options={savedAccounts} onchange={selectAccount}></base-select>
                <span class="slds-m-horizontal--small">Planet:</span>
                <lightning-button-icon icon-name="utility:back" variant="bare" onclick={previousPlanet}></lightning-button-icon>
                <base-select class="planets slds-show_inline-block slds-m-horizontal--xx-small"
                            value={cache.coords} options={planets} onchange={changePlanet}></base-select>
                <lightning-button-icon icon-name="utility:forward" variant="bare" onclick={nextPlanet}></lightning-button-icon>
            </section>
            <lightning-accordion allow-multiple-sections-open active-section-name="Gebäude">
                <lightning-accordion-section for:each={constructions} for:item="construction" key={construction.label}
                                            label={construction.label} name={construction.label}>
                    <a for:each={construction.options} for:item="option" key={option} onclick={build}
                        href="javascript:void(0)"
                        class="slds-show_inline-block slds-m-around--xxx-small slds-p-horizontal--xx-small"
                        ondragstart={drag}
                        draggable>{option}</a>
                </lightning-accordion-section>
            </lightning-accordion>
        </div>
        <div class="slds-col slds-size_2-of-3 slds-p-horizontal--medium">
            <section class="slds-p-bottom--x-small">
                <base-toggle label="Ressourcen selbst Produzieren" class="slds-show_inline-block" checked={cache.produce} onchange={toggleProduce}></base-toggle>
                <b class="slds-m-horizontal--medium">Summe: ( {generated} )</b>
                <lightning-button-group>
                    <lightning-button variant="brand" disabled={cache.produce} onclick={resetCount} label="Begleichen"></lightning-button>
                    <lightning-button variant="brand" onclick={rerender} label="Auf alles anwenden"></lightning-button>
                </lightning-button-group>
            </section>
            <section class="ressources slds-grid slds-grid--vertical-stretch slds-size_small slds-p-bottom--x-small">
                <div if:true={account} for:each={resources} for:item="res" key={res.name}
                        class="slds-col slds-p-horizontal--xxx-small">
                    <span class="slds-align_absolute-center">{res.name}</span>
                    <span class="slds-align_absolute-center">{res.stored}&nbsp;({res.hourlyProduction})</span>
                    <input type="number" step="1" class="res slds-input" value="0" />
                </div>
                <div class="slds-col slds-p-horizontal--xxx-small">
                    <span class="slds-align_absolute-center">Zeit</span>
                    <span class="slds-align_absolute-center">{timePassed}</span>
                    <input type="time" step="1" value="00:00:00" class="wait slds-input" required/>
                </div>
                <div class="slds-col slds-p-horizontal--xxx-small allign-bottom">
                    <lightning-button variant="brand" onclick={applyManualChanges} label="Verrechnen"></lightning-button>
                </div>
            </section>

            <section>
                <lightning-button variant="brand" onclick={complete} label="Alles fertig bauen"></lightning-button>
                <base-toggle label="Details" class="slds-show_inline-block slds-m-left--small" checked={showDetails} onchange={toggleDetails}></base-toggle>
                <lightning-button variant="brand" onclick={reset} label="RESET"></lightning-button>
                <lightning-button-icon icon-name="utility:undo" variant="bare" onclick={undo} disabled={undoDisabled} title="CTRL+Z" class="slds-m-left--small"></lightning-button-icon>
                <lightning-button-icon icon-name="utility:redo" variant="bare" onclick={redo} disabled={redoDisabled} title="CTRL+Y" class="slds-m-left--small"></lightning-button-icon>
            </section>

            <gw-path-logger hide-details={cache.hideDetails}
                            onjumpto={jumpTo}
                            onmove={move}
                            onremove={remove}
                            onduplicate={duplicate}></gw-path-logger>

            <lightning-accordion allow-multiple-sections-open>
                <lightning-accordion-section label="Pfad" name="Pfad">
                    <section class="slds-p-vertical--x-small">
                        <input value={selectedPath} class="path-name slds-input slds-m-right--small"/>
                        <lightning-button variant="success" onclick={savePath} label="Speichern"></lightning-button>
                    </section>
                    <section class="slds-p-bottom--x-small">
                        <base-select class="slds-show_inline-block"
                                    value={selectedPath} options={savedPaths} onchange={selectPath}></base-select>
                        <span class="slds-m-horizontal--x-small">vom Speicher</span>
                        <lightning-button-group>
                            <lightning-button variant="success" onclick={loadPath} label="Laden"></lightning-button>
                            <lightning-button variant="destructive" onclick={deletePath} label="Löschen"></lightning-button>
                            <lightning-button variant="destructive" onclick={deletePaths} label="Alle Pfade löschen"></lightning-button>
                        </lightning-button-group>
                    </section>
                    <section class="slds-p-bottom--x-small">
                        <textarea class="path slds-theme_offline slds-" rows="1" cols="40"></textarea>
                        <lightning-button-group class="slds-m-left--small">
                            <lightning-button variant="brand" onclick={executePasted} label="Ausführen"></lightning-button>
                            <lightning-button variant="brand" onclick={copy} label="kopieren"></lightning-button>
                        </lightning-button-group>
                    </section>
                </lightning-accordion-section>
            </lightning-accordion>
        </div>
    </div>
</template>
